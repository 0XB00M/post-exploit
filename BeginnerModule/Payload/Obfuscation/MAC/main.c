#include "./fuscation.h"
#include "./deobfuscation.h"


unsigned char* shellcode2 = "\x7d\x6f\x67\xf2\xa8\x2d";
char* MacArray[] = {"7D-6F-67-F2-A8-2D"};

int main() {


	//GenerateMacOutput(unsigned char* pShellcode, SIZE_T ShellcodeSize)
	GenerateMacOutput(shellcode2, 6);

	
	SIZE_T NmbrOfElements = 1 ;
	PBYTE pDAddress = NULL;
	SIZE_T sDSize = NULL;
	//MacDeobfuscation(IN CHAR* MacArray[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize)
	MacDeobfuscation(MacArray, NmbrOfElements, &pDAddress, &sDSize);


	printf("[+] Deobfuscated Bytes at 0x%p of Size %ld ::: \n", pDAddress, sDSize);
	for (size_t i = 0; i < sDSize; i++) {
		if (i % 16 == 0)
			printf("\n\t");
		printf("%0.2X ", pDAddress[i]);
	}

	HeapFree(GetProcessHeap(), 0, pDAddress);

	return 0;
}