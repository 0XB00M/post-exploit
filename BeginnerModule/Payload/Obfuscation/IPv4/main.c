#include "./fuscation.h"
#include "./deobfuscation.h"

unsigned char shellcode[] = { 0XB4, 0X23, 0X34, 0X0A };



int main() {


	

	if (!GenerateIpv4Output(shellcode, sizeof(shellcode))) {
		return -1;
	}


	// Variable for Deobfuscation
	char* Ipv4Array[1] = {
		"180.35.52.10"
	};
	SIZE_T NumberOfElements = 1;
	// ppDaddress store deobfuscated payload.
	// pDSize store deobfuscated payload size.
	PBYTE	pDAddress = NULL;
	SIZE_T	sDSize = NULL;


	/* IN CHAR* Ipv4Array[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize */
	if (!Ipv4Deobfuscation(Ipv4Array, NumberOfElements, &pDAddress, &sDSize))
		return -1;

	printf("[+] Deobfuscated Bytes at 0x%p of Size %ld ::: \n", pDAddress, sDSize);
	for (size_t i = 0; i < sDSize; i++) {
		if (i % 16 == 0)
			printf("\n\t");
		printf("%0.2X ", pDAddress[i]);
	}

	HeapFree(GetProcessHeap(), 0, pDAddress);




	return 0;

}
