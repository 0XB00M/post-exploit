#include "./fuscation.h"
#include "./deobfuscation.h"



unsigned char shellcode[] = { 0xDD, 0xF2, 0x15, 0x81, 0x67, 0xD2, 0xAA, 0x59, 0xB0, 0xA0, 0x5F, 0xE8 , 0xBD, 0xB4, 0xF8, 0x3A };



int main(void) {



	//GenerateIpv6Output(unsigned char* pShellcode, SIZE_T ShellcodeSize)
	GenerateIpv6Output(shellcode, sizeof(shellcode));



	//DDF2:1581:67D2:AA59:B0A0:5FE8:BDB4:F83A
	//Ipv6Deobfuscation(IN CHAR* Ipv6Array[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize)
	char* Ipv6Array[] = { "DDF2:1581:67D2:AA59:B0A0:5FE8:BDB4:F83A" };
	SIZE_T NmbrOfElements = 1;
	PBYTE	pDAddress = NULL;
	SIZE_T	sDSize = NULL;



	
	Ipv6Deobfuscation(&Ipv6Array, NmbrOfElements, &pDAddress, &sDSize);
	for (size_t i = 0; i < sDSize; i++) {
		if (i % 16 == 0)
			printf("\n\t");

		printf("%0.2X ", pDAddress[i]);
	}
	HeapFree(GetProcessHeap(), 0, pDAddress);

	return 0;

}
