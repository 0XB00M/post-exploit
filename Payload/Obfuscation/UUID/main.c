#include "./fuscation.h"
#include "./deobfuscation.h"


unsigned char* shellcode = "\xDE\x72\xC3\x4E\x08\xBD\x34\x71\x9E\xB6\x52\x2B\xFE\xD9\xA4\x37 ";
char* UuidArray[] = { "4EC372DE-BD08-7134-9EB6-522BFED9A437" };

int main() {


	//GenerateUuidOutput(unsigned char* pShellcode, SIZE_T ShellcodeSize)
	GenerateUuidOutput(shellcode, strlen(shellcode) - 1);


	//UuidDeobfuscation(IN CHAR* UuidArray[], IN SIZE_T NmbrOfElements, OUT PBYTE* ppDAddress, OUT SIZE_T* pDSize)
	PBYTE pDAddress = NULL;
	SIZE_T sDSize = NULL;
	UuidDeobfuscation(UuidArray, 1, &pDAddress, &sDSize);
	printf("[+] Deobfuscated Bytes at 0x%p of Size %ld ::: \n", pDAddress, sDSize);
	for (size_t i = 0; i < sDSize; i++) {
		if (i % 16 == 0)
			printf("\n\t");
		printf("%0.2X ", pDAddress[i]);
	}

	HeapFree(GetProcessHeap(), 0, pDAddress);
	
	

	return 0;
}