#include <stdio.h>
#include <windows.h>

#define STATUS_SUCCESS ((NTSTATUS)0x00000000)

int getusername(void) {

	/*
	BOOL GetUserNameA(
	  [out]     LPSTR   lpBuffer,
	  [in, out] LPDWORD pcbBuffer
	);
	*/

	char username[100];
	DWORD size = 100;
	LPDWORD pcbBuffer = &size;

	// Get call directly from the kernel
	NTSTATUS STATUS = GetUserNameA(username, pcbBuffer);
	if (STATUS == STATUS_SUCCESS) {
		printf("[#] Status success\n");
	}
	printf("Status: 0x%0.8X\n", STATUS);
	printf("Username: %s\n", username);
	printf("Size: %d \n", *pcbBuffer);
	

	return 0;
}
